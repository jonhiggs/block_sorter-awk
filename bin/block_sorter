#!/usr/bin/env bash
ROOT_DIR="$(dirname $0)/../"

block_count() {
  awk '
    BEGIN    { c=0 }
    /^[^\ ]/  { c+=1 }
    END      { print c-1 }
  ' ${INPUT_FILE}
}

block() {
  awk \
    -f ${ROOT_DIR}/lib/block_split.awk \
    block=$1 \
    ${INPUT_FILE}
}

INPUT_FILE=$1
ITERATIONS=${2:-$(block_count)}

for i in $(seq 0 ${ITERATIONS}); do
  block_data=$(block $i)
  echo "${block_data}" | sed '1!d'
  echo "${block_data}" | sed '1d' | sort
done
